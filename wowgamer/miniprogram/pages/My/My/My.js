"use strict";
var app = getApp();
Page({
    data: {
        userId: '',
        userName: '',
        userImage: '',
        displayAddUser: false,
        displayAddUserInput: false,
        isLogin: true,
        accountList: [],
        newAccountName: ''
    },
    onLoad: function () {
        this.setData({
            userId: wx.getStorageSync('id')
        });
    },
    onShow: function () {
        var _this_1 = this;
        if (!this.data.userName || !this.data.userImage) {
            app.requestFunc('/user/getUserInfo', { userId: this.data.userId }, 'GET', function (res) {
                console.log(res.data);
                if (res.data.success == true) {
                    _this_1.setData({
                        userName: res.data.userInfo.userName,
                        userImage: res.data.userInfo.image
                    });
                }
            });
        }
    },
    displayAddUserFn: function () {
        var _this_1 = this;
        this.setData({
            displayAddUser: !this.data.displayAddUser
        });
        app.requestFunc('/user/getAccountList', { userId: this.data.userId }, 'GET', function (res) {
            console.log(res.data);
            if (res.data.success == true) {
                _this_1.setData({
                    accountList: res.data.accountList
                });
            }
        });
    },
    bindInputNewAccountName: function (e) {
        this.setData({
            newAccountName: e.detail.value
        });
    },
    saveNewAccount: function () {
        var _this_1 = this;
        app.requestFunc('/user/saveAccount', { userId: this.data.userId, accountName: this.data.newAccountName }, 'POST', function (res) {
            console.log(res.data);
            if (res.data.success == true) {
                console.log(res.data.msg);
                app.requestFunc('/user/getAccountList', { userId: _this_1.data.userId }, 'GET', function (res) {
                    console.log(res.data);
                    if (res.data.success == true) {
                        _this_1.setData({
                            accountList: res.data.accountList
                        });
                    }
                });
            }
        });
    },
    displayAddUserInputFn: function () {
        this.setData({
            displayAddUserInput: !this.data.displayAddUserInput
        });
    },
    navToMyInformation: function () {
        wx.navigateTo({
            url: '../MyInformation/MyInformation?id=' + this.data.userId,
            success: function (res) { },
            fail: function () { },
            complete: function () { }
        });
    },
    navToMyAccount: function (e) {
        wx.navigateTo({
            url: '../MyAccount/MyAccount?id=' + this.data.userId + '&accountId=' + e.currentTarget.dataset.accountid,
            success: function (res) { },
            fail: function () { },
            complete: function () { }
        });
    },
    navToAbout: function () {
    },
    deleteCurrentAcount: function (e) {
        var _this = this;
        wx.showModal({
            title: '提示',
            content: '删除子账号后,子账号下面的角色都将被自动删除~',
            success: function (res) {
                if (res.confirm) {
                    app.requestFunc('/user/deleteAccount', { userId: _this.data.userId, accountId: e.currentTarget.dataset.accountid }, 'POST', function (res) {
                        console.log(res.data);
                        if (res.data.success == true) {
                            console.log(res.data.msg);
                            wx.showToast({
                                title: res.data.msg,
                                icon: 'success',
                                duration: 2000
                            });
                            app.requestFunc('/user/getAccountList', { userId: _this.data.userId }, 'GET', function (res) {
                                console.log(res.data);
                                if (res.data.success == true) {
                                    _this.setData({
                                        accountList: res.data.accountList
                                    });
                                }
                            });
                        }
                    });
                }
                else if (res.cancel) {
                    console.log('用户点击取消');
                }
            }
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTXkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJNeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsSUFBTSxHQUFHLEdBQUcsTUFBTSxFQUFjLENBQUE7QUFFaEMsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osTUFBTSxFQUFFLEVBQUU7UUFDVixRQUFRLEVBQUUsRUFBRTtRQUNaLFNBQVMsRUFBRSxFQUFFO1FBQ2IsY0FBYyxFQUFFLEtBQUs7UUFDckIsbUJBQW1CLEVBQUUsS0FBSztRQUMxQixPQUFPLEVBQUUsSUFBSTtRQUNiLFdBQVcsRUFBRSxFQUFFO1FBQ2YsY0FBYyxFQUFDLEVBQUU7S0FDbEI7SUFLRCxNQUFNLEVBQUU7UUFDTixJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsTUFBTSxFQUFFLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDO1NBQ2hDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxNQUFNLEVBQUU7UUFBQSxtQkFZUDtRQVhDLElBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQzlDLEdBQUcsQ0FBQyxXQUFXLENBQUMsbUJBQW1CLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUMsRUFBRSxLQUFLLEVBQUUsVUFBQSxHQUFHO2dCQUN6RSxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDdEIsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sSUFBSSxJQUFJLEVBQUU7b0JBQzVCLE9BQUksQ0FBQyxPQUFPLENBQUM7d0JBQ1gsUUFBUSxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVE7d0JBQ3BDLFNBQVMsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLO3FCQUNuQyxDQUFDLENBQUE7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LE9BQU8sSUFBSSxJQUFJLEVBQUU7b0NBQzVCLEtBQUssQ0FBQyxPQUFPLENBQUM7d0NBQ1osV0FBVyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVztxQ0FDbEMsQ0FBQyxDQUFBO2lDQUNIOzRCQUNILENBQUMsQ0FBQyxDQUFBO3lCQUNIO29CQUNILENBQUMsQ0FBQyxDQUFBO2lCQUNIO3FCQUFNLElBQUksR0FBRyxDQUFDLE1BQU0sRUFBRTtvQkFDckIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQTtpQkFDdEI7WUFDSCxDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBQ0osQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIGluZGV4LnRzXG4vLyDojrflj5blupTnlKjlrp7kvotcbmNvbnN0IGFwcCA9IGdldEFwcDxJQXBwT3B0aW9uPigpXG5cblBhZ2Uoe1xuICBkYXRhOiB7XG4gICAgdXNlcklkOiAnJyxcbiAgICB1c2VyTmFtZTogJycsXG4gICAgdXNlckltYWdlOiAnJyxcbiAgICBkaXNwbGF5QWRkVXNlcjogZmFsc2UsXG4gICAgZGlzcGxheUFkZFVzZXJJbnB1dDogZmFsc2UsXG4gICAgaXNMb2dpbjogdHJ1ZSxcbiAgICBhY2NvdW50TGlzdDogW10sXG4gICAgbmV3QWNjb3VudE5hbWU6JydcbiAgfSxcbiAgXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWKoOi9vVxuICAgKi9cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHVzZXJJZDogd3guZ2V0U3RvcmFnZVN5bmMoJ2lkJylcbiAgICB9KVxuICB9LFxuICBvblNob3c6IGZ1bmN0aW9uICgpIHtcbiAgICBpZighdGhpcy5kYXRhLnVzZXJOYW1lIHx8ICF0aGlzLmRhdGEudXNlckltYWdlKSB7XG4gICAgICBhcHAucmVxdWVzdEZ1bmMoJy91c2VyL2dldFVzZXJJbmZvJywge3VzZXJJZDogdGhpcy5kYXRhLnVzZXJJZH0sICdHRVQnLCByZXMgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7XG4gICAgICAgIGlmIChyZXMuZGF0YS5zdWNjZXNzID09IHRydWUpIHtcbiAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgdXNlck5hbWU6IHJlcy5kYXRhLnVzZXJJbmZvLnVzZXJOYW1lLFxuICAgICAgICAgICAgdXNlckltYWdlOiByZXMuZGF0YS51c2VySW5mby5pbWFnZVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9LFxuICBkaXNwbGF5QWRkVXNlckZuKCkge1xuICAgIHRoaXMuc2V0RGF0YSh7IFxuICAgICAgZGlzcGxheUFkZFVzZXIgOiAhdGhpcy5kYXRhLmRpc3BsYXlBZGRVc2VyXG4gICAgIH0pXG4gICAgIGFwcC5yZXF1ZXN0RnVuYygnL3VzZXIvZ2V0QWNjb3VudExpc3QnLCB7dXNlcklkOiB0aGlzLmRhdGEudXNlcklkfSwgJ0dFVCcsIHJlcyA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7XG4gICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcyA9PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgYWNjb3VudExpc3Q6IHJlcy5kYXRhLmFjY291bnRMaXN0XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgYmluZElucHV0TmV3QWNjb3VudE5hbWUoZSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBuZXdBY2NvdW50TmFtZTogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuICBzYXZlTmV3QWNjb3VudCgpIHtcbiAgICBhcHAucmVxdWVzdEZ1bmMoJy91c2VyL3NhdmVBY2NvdW50Jywge3VzZXJJZDogdGhpcy5kYXRhLnVzZXJJZCwgYWNjb3VudE5hbWU6IHRoaXMuZGF0YS5uZXdBY2NvdW50TmFtZX0sICdQT1NUJywgcmVzID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTtcbiAgICAgIGlmIChyZXMuZGF0YS5zdWNjZXNzID09IHRydWUpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEubXNnKTtcblxuICAgICAgICBhcHAucmVxdWVzdEZ1bmMoJy91c2VyL2dldEFjY291bnRMaXN0Jywge3VzZXJJZDogdGhpcy5kYXRhLnVzZXJJZH0sICdHRVQnLCByZXMgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTtcbiAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcyA9PSB0cnVlKSB7XG4gICAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgICBhY2NvdW50TGlzdDogcmVzLmRhdGEuYWNjb3VudExpc3RcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH0sXG4gIGRpc3BsYXlBZGRVc2VySW5wdXRGbigpIHtcbiAgICB0aGlzLnNldERhdGEoeyBcbiAgICAgIGRpc3BsYXlBZGRVc2VySW5wdXQgOiAhdGhpcy5kYXRhLmRpc3BsYXlBZGRVc2VySW5wdXRcbiAgICAgfSlcbiAgfSxcbiAgbmF2VG9NeUluZm9ybWF0aW9uKCkge1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOiAnLi4vTXlJbmZvcm1hdGlvbi9NeUluZm9ybWF0aW9uP2lkPScgKyB0aGlzLmRhdGEudXNlcklkLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXsgfSxcbiAgICAgIGZhaWw6IGZ1bmN0aW9uKCkgeyB9LFxuICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCkgeyB9XG4gICAgfSlcbiAgfSxcbiAgbmF2VG9NeUFjY291bnQoZSkge1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOiAnLi4vTXlBY2NvdW50L015QWNjb3VudD9pZD0nICsgdGhpcy5kYXRhLnVzZXJJZCArICcmYWNjb3VudElkPScgKyBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5hY2NvdW50aWQsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpeyB9LFxuICAgICAgZmFpbDogZnVuY3Rpb24oKSB7IH0sXG4gICAgICBjb21wbGV0ZTogZnVuY3Rpb24oKSB7IH1cbiAgICB9KVxuICB9LFxuICBuYXZUb0Fib3V0KCkge1xuICB9LFxuICBkZWxldGVDdXJyZW50QWNvdW50KGUpIHtcbiAgICBjb25zdCBfdGhpcyA9IHRoaXNcbiAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgY29udGVudDogJ+WIoOmZpOWtkOi0puWPt+WQjizlrZDotKblj7fkuIvpnaLnmoTop5LoibLpg73lsIbooqvoh6rliqjliKDpmaR+JyxcbiAgICAgIHN1Y2Nlc3MgKHJlcykge1xuICAgICAgICBpZiAocmVzLmNvbmZpcm0pIHtcbiAgICAgICAgICBhcHAucmVxdWVzdEZ1bmMoJy91c2VyL2RlbGV0ZUFjY291bnQnLCB7dXNlcklkOiBfdGhpcy5kYXRhLnVzZXJJZCwgYWNjb3VudElkOiBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5hY2NvdW50aWR9LCAnUE9TVCcsIHJlcyA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7XG4gICAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcyA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhLm1zZyk7XG4gICAgICAgICAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHJlcy5kYXRhLm1zZyxcbiAgICAgICAgICAgICAgICBpY29uOiAnc3VjY2VzcycsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDBcbiAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICBhcHAucmVxdWVzdEZ1bmMoJy91c2VyL2dldEFjY291bnRMaXN0Jywge3VzZXJJZDogX3RoaXMuZGF0YS51c2VySWR9LCAnR0VUJywgcmVzID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN1Y2Nlc3MgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRMaXN0OiByZXMuZGF0YS5hY2NvdW50TGlzdFxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmIChyZXMuY2FuY2VsKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+eUqOaIt+eCueWHu+WPlua2iCcpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICB9XG59KVxuIl19