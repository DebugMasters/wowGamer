"use strict";
const app = getApp();
Page({
    data: {
        userId: '',
        catalogType: '1',
        displayType: 1,
        index: 0,
        level1Content: new Array(),
        level1Index: 0,
        level1Money: 0,
        level2Content: new Array(),
        level2DisplayName: '',
        level2Currentlevel: NaN,
        level2Targetlevel: NaN,
        level2Index: 0,
        level2Money: 0,
        level3Content: new Array(),
        level3DisplayName: '',
        level3Index: 0,
        level3Money: 0,
        charactersContent: new Array(),
        charactersIndex: 0,
        totalMoney: 0,
        allianceHordeMap: new Map(),
        characterClassMap: new Map(),
    },
    onLoad() {
        this.setData({
            userId: wx.getStorageSync('id'),
            allianceHordeMap: new Map([[1, '联盟'], [2, '部落']]),
            characterClassMap: new Map([[1, '圣骑士'], [2, '战士'], [3, '死亡骑士'], [4, '猎人'], [5, '萨满祭司'], [6, '潜行者'], [7, '德鲁伊'], [8, '恶魔猎手'], [9, '法师'], [10, '牧师'], [11, '术士']])
        });
        this.getLevel1();
    },
    onShow() {
        this.getCharacters();
    },
    getLevel1() {
        app.requestFuncPromise('/system/getCatalogList', { parentId: '0', catalogType: parseInt(this.data.catalogType) }, 'GET')
            .then(res => {
            let data = {
                level1Content: new Array(),
                level1Money: res.data.catalogList[0].money
            };
            res.data.catalogList.forEach(x => {
                data.level1Content.push({ id: x.id, name: x.catalogName });
            });
            this.setData(data);
            this.getLevel2(res.data.catalogList[0].id);
        })
            .catch(res => {
            console.log(res);
        });
    },
    level1Change(e) {
        this.setData({
            level1Index: parseInt(e.detail.value)
        });
        this.getLevel2(this.data.level1Content[this.data.level1Index].id);
    },
    getLevel2(parentId) {
        app.requestFuncPromise('/system/getCatalogList', { parentId: parentId, catalogType: parseInt(this.data.catalogType) }, 'GET')
            .then(res => {
            this.setData({
                displayType: res.data.catalogList[0].catalogDisplayType,
                level2DisplayName: res.data.catalogList[0].catalogDisplayName,
                level2Money: res.data.catalogList[0].money
            });
            if (this.data.displayType == 1) {
                let data = {
                    level2Content: new Array(),
                };
                res.data.catalogList.forEach(x => {
                    data.level2Content.push({ id: x.id, name: x.catalogName });
                });
                this.setData(data);
            }
            if (this.data.displayType == 2) {
                let temp = res.data.catalogList[0].catalogName.split('-');
                let data = {
                    level2Currentlevel: parseInt(temp[0]),
                    level2Targetlevel: parseInt(temp[1])
                };
                this.setData(data);
            }
            this.getLevel3(res.data.catalogList[0].id);
        })
            .catch(res => {
            console.log(res);
        });
    },
    level2Change(e) {
        this.setData({
            level2Index: parseInt(e.detail.value)
        });
        this.getLevel3(this.data.level2Content[this.data.level2Index].id);
    },
    getLevel3(parentId) {
        app.requestFuncPromise('/system/getCatalogList', { parentId: parentId, catalogType: parseInt(this.data.catalogType) }, 'GET')
            .then(res => {
            let data = {
                level3Content: new Array(),
                level3DisplayName: res.data.catalogList[0].catalogDisplayName,
                level3Money: res.data.catalogList[0].money
            };
            res.data.catalogList.forEach(x => {
                data.level3Content.push({ id: x.id, name: x.catalogName });
            });
            this.setData(data);
            this.calcTotalMoney();
        })
            .catch(res => {
            console.log(res);
        });
    },
    level3Change(e) {
        this.setData({
            level3Index: parseInt(e.detail.value)
        });
    },
    level2CurrentLevelBlur() {
        this.calcTotalMoney();
    },
    level2TargetLevelBlur() {
        this.calcTotalMoney();
    },
    level2CurrentLevelInput(e) {
        this.setData({
            level2Currentlevel: parseInt(e.detail.value)
        });
    },
    level2TargetLevelInput(e) {
        this.setData({
            level2Targetlevel: parseInt(e.detail.value)
        });
    },
    calcTotalMoney() {
        if (this.data.displayType == 1) {
            this.setData({
                totalMoney: this.data.level1Money + this.data.level2Money + this.data.level3Money
            });
        }
        if (this.data.displayType == 2) {
            this.setData({
                totalMoney: this.data.level1Money + (this.data.level2Targetlevel - this.data.level2Currentlevel) * this.data.level2Money + this.data.level3Money
            });
        }
    },
    getCharacters() {
        const _this = this;
        app.requestFunc('/user/getCharacterList', { userId: this.data.userId, realmType: this.data.catalogType }, 'GET', res => {
            console.log(res.data);
            if (res.data.success == true) {
                let data = {
                    charactersContent: new Array()
                };
                res.data.list.forEach(x => {
                    data.charactersContent.push({ id: x.characterId, name: x.characterName + '(' + x.accountName + ')' + '/' + _this.data.allianceHordeMap.get(x.allianceHorde) + '/' + _this.data.characterClassMap.get(x.characterClass) });
                });
                this.setData(data);
            }
        });
    },
    charactersChange(e) {
        this.setData({
            charactersIndex: parseInt(e.detail.value)
        });
    },
    changeCatalogType(e) {
        this.setData({
            catalogType: e.currentTarget.dataset.type
        });
        this.getLevel1();
        this.getCharacters();
    },
    NavToCreateOrder() {
        let transdata = {
            characterName: this.data.charactersContent[this.data.charactersIndex].name,
            orderCatalog: '',
            orderCatalog1: this.data.level1Content[this.data.level1Index].id,
            orderCatalog2: this.data.level2Content[this.data.level2Index].id,
            orderCatalog3: this.data.level3Content[this.data.level3Index].id,
            money: this.data.totalMoney,
            characterId: this.data.charactersContent[this.data.charactersIndex].id
        };
        if (this.data.displayType == 1) {
            transdata.orderCatalog = this.data.level1Content[this.data.level1Index].name + '/' + this.data.level2Content[this.data.level2Index].name + '/' + this.data.level3Content[this.data.level3Index].name;
        }
        if (this.data.displayType == 2) {
            transdata.orderCatalog = this.data.level1Content[this.data.level1Index].name + '/' + this.data.level2Currentlevel + '-' + this.data.level2Targetlevel + '/' + this.data.level3Content[this.data.level3Index].name;
        }
        const comData = JSON.stringify(transdata);
        wx.navigateTo({
            url: '../../OrderService/OrderEntry/OrderEntry' + '?data=' + comData,
            success: function (res) { },
            fail: function () { },
            complete: function () { }
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT3JkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJPcmRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsTUFBTSxHQUFHLEdBQUcsTUFBTSxFQUFjLENBQUE7QUFFaEMsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osTUFBTSxFQUFFLEVBQUU7UUFDVixXQUFXLEVBQUUsR0FBRztRQUNoQixXQUFXLEVBQUUsQ0FBQztRQUVkLEtBQUssRUFBRSxDQUFDO1FBQ1IsYUFBYSxFQUFFLElBQUksS0FBSyxFQUE4QjtRQUN0RCxXQUFXLEVBQUUsQ0FBQztRQUNkLFdBQVcsRUFBRSxDQUFDO1FBQ2QsYUFBYSxFQUFFLElBQUksS0FBSyxFQUE4QjtRQUN0RCxpQkFBaUIsRUFBRSxFQUFFO1FBQ3JCLGtCQUFrQixFQUFFLEdBQUc7UUFDdkIsaUJBQWlCLEVBQUUsR0FBRztRQUN0QixXQUFXLEVBQUUsQ0FBQztRQUNkLFdBQVcsRUFBRSxDQUFDO1FBQ2QsYUFBYSxFQUFFLElBQUksS0FBSyxFQUE4QjtRQUN0RCxpQkFBaUIsRUFBRSxFQUFFO1FBQ3JCLFdBQVcsRUFBRSxDQUFDO1FBQ2QsV0FBVyxFQUFFLENBQUM7UUFDZCxpQkFBaUIsRUFBRSxJQUFJLEtBQUssRUFBOEI7UUFDMUQsZUFBZSxFQUFFLENBQUM7UUFDbEIsVUFBVSxFQUFFLENBQUM7UUFDYixnQkFBZ0IsRUFBRSxJQUFJLEdBQUcsRUFBRTtRQUMzQixpQkFBaUIsRUFBRSxJQUFJLEdBQUcsRUFBRTtLQUU3QjtJQUNELE1BQU07UUFDSixJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsTUFBTSxFQUFFLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDO1lBQy9CLGdCQUFnQixFQUFFLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUNqRCxpQkFBaUIsRUFBRSxJQUFJ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QVEsR0FBRyxPQUFPO1lBQ3BFLE9BQU8sRUFBRSxVQUFTLEdBQUcsSUFBRyxDQUFDO1lBQ3pCLElBQUksRUFBRSxjQUFhLENBQUM7WUFDcEIsUUFBUSxFQUFFLGNBQWEsQ0FBQztTQUN6QixDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW5kZXgudHNcbi8vIOiOt+WPluW6lOeUqOWunuS+i1xuY29uc3QgYXBwID0gZ2V0QXBwPElBcHBPcHRpb24+KClcblxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICB1c2VySWQ6ICcnLFxuICAgIGNhdGFsb2dUeXBlOiAnMScsXG4gICAgZGlzcGxheVR5cGU6IDEsXG5cbiAgICBpbmRleDogMCxcbiAgICBsZXZlbDFDb250ZW50OiBuZXcgQXJyYXk8e2lkOiBzdHJpbmcsIG5hbWU6IHN0cmluZ30+KCksXG4gICAgbGV2ZWwxSW5kZXg6IDAsXG4gICAgbGV2ZWwxTW9uZXk6IDAsXG4gICAgbGV2ZWwyQ29udGVudDogbmV3IEFycmF5PHtpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmd9PigpLFxuICAgIGxldmVsMkRpc3BsYXlOYW1lOiAnJyxcbiAgICBsZXZlbDJDdXJyZW50bGV2ZWw6IE5hTixcbiAgICBsZXZlbDJUYXJnZXRsZXZlbDogTmFOLFxuICAgIGxldmVsMkluZGV4OiAwLFxuICAgIGxldmVsMk1vbmV5OiAwLFxuICAgIGxldmVsM0NvbnRlbnQ6IG5ldyBBcnJheTx7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nfT4oKSxcbiAgICBsZXZlbDNEaXNwbGF5TmFtZTogJycsXG4gICAgbGV2ZWwzSW5kZXg6IDAsXG4gICAgbGV2ZWwzTW9uZXk6IDAsXG4gICAgY2hhcmFjdGVyc0NvbnRlbnQ6IG5ldyBBcnJheTx7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nfT4oKSxcbiAgICBjaGFyYWN0ZXJzSW5kZXg6IDAsXG4gICAgdG90YWxNb25leTogMCxcbiAgICBhbGxpYW5jZUhvcmRlTWFwOiBuZXcgTWFwKCksXG4gICAgY2hhcmFjdGVyQ2xhc3NNYXA6IG5ldyBNYXAoKSxcblxuICB9LFxuICBvbkxvYWQoKSB7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHVzZXJJZDogd3guZ2V0U3RvcmFnZVN5bmMoJ2lkJyksXG4gICAgICBhbGxpYW5jZUhvcmRlTWFwOiBuZXcgTWFwKFtbMSwgJ+iBlOebnyddLCBbMiwgJ+mDqOiQvSddXSksXG4gICAgICBjaGFyYWN0ZXJDbGFzc01hcDogbmV3IE1hcChbWzEsICflnKPpqpHlo6snXSwgWzIsICfmiJjlo6snXSwgWzMsICfmrbvkuqHpqpHlo6snXSwgWzQsICfnjI7kuronXSwgWzUsICfokKjmu6Hnpa3lj7gnXSwgWzYsICfmvZzooYzogIUnXSwgWzcsICflvrfpsoHkvIonXSwgWzgsICfmgbbprZTnjI7miYsnXSwgWzksICfms5XluIgnXSwgWzEwLCAn54mn5biIJ10sIFsxMSwgJ+acr+WjqyddXSlcbiAgICB9KVxuICAgIHRoaXMuZ2V0TGV2ZWwxKCk7XG4gICAgXG4gIH0sXG4gIG9uU2hvdygpIHtcbiAgICB0aGlzLmdldENoYXJhY3RlcnMoKTtcbiAgfSxcbiAgZ2V0TGV2ZWwxKCkge1xuICAgIGFwcC5yZXF1ZXN0RnVuY1Byb21pc2UoJy9zeXN0ZW0vZ2V0Q2F0YWxvZ0xpc3QnLCB7cGFyZW50SWQ6ICcwJywgY2F0YWxvZ1R5cGU6IHBhcnNlSW50KHRoaXMuZGF0YS5jYXRhbG9nVHlwZSl9LCAnR0VUJylcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgIGxldmVsMUNvbnRlbnQ6IG5ldyBBcnJheTx7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nfT4oKSxcbiAgICAgICAgbGV2ZWwxTW9uZXk6IHJlcy5kYXRhLmNhdGFsb2dMaXN0WzBdLm1vbmV5XG4gICAgICB9XG4gICAgICByZXMuZGF0YS5jYXRhbG9nTGlzdC5mb3JFYWNoKHggPT4ge1xuICAgICAgICBkYXRhLmxldmVsMUNvbnRlbnQucHVzaCh7aWQ6IHguaWQsIG5hbWU6IHguY2F0YWxvZ05hbWV9KSAgXG4gICAgICB9KTtcbiAgICAgIHRoaXMuc2V0RGF0YShkYXRhKTtcbiAgICAgIHRoaXMuZ2V0TGV2ZWwyKHJlcy5kYXRhLmNhdGFsb2dMaXN0WzBdLmlkKTtcbiAgICB9KVxuICAgIC5jYXRjaChyZXMgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICB9KVxuICB9LFxuICBsZXZlbDFDaGFuZ2UoZSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBsZXZlbDFJbmRleDogcGFyc2VJbnQoZS5kZXRhaWwudmFsdWUpXG4gICAgfSlcbiAgICB0aGlzLmdldExldmVsMih0aGlzLmRhdGEubGV2ZWwxQ29udGVudFt0aGlzLmRhdGEubGV2ZWwxSW5kZXhdLmlkKVxuICB9LFxuICBnZXRMZXZlbDIocGFyZW50SWQ6IHN0cmluZykge1xuICAgIGFwcC5yZXF1ZXN0RnVuY1Byb21pc2UoJy9zeXN0ZW0vZ2V0Q2F0YWxvZ0xpc3QnLCB7cGFyZW50SWQ6IHBhcmVudElkLCBjYXRhbG9nVHlwZTogcGFyc2VJbnQodGhpcy5kYXRhLmNhdGFsb2dUeXBlKX0sICdHRVQnKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICBkaXNwbGF5VHlwZTogcmVzLmRhdGEuY2F0YWxvZ0xpc3RbMF0uY2F0YWxvZ0Rpc3BsYXlUeXBlLFxuICAgICAgICBsZXZlbDJEaXNwbGF5TmFtZTogcmVzLmRhdGEuY2F0YWxvZ0xpc3RbMF0uY2F0YWxvZ0Rpc3BsYXlOYW1lLFxuICAgICAgICBsZXZlbDJNb25leTogcmVzLmRhdGEuY2F0YWxvZ0xpc3RbMF0ubW9uZXlcbiAgICAgIH0pIFxuICAgICAgaWYodGhpcy5kYXRhLmRpc3BsYXlUeXBlID09IDEpIHtcbiAgICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICAgbGV2ZWwyQ29udGVudDogbmV3IEFycmF5PHtpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmd9PigpLFxuICAgICAgICB9XG4gICAgICAgIHJlcy5kYXRhLmNhdGFsb2dMaXN0LmZvckVhY2goeCA9PiB7XG4gICAgICAgICAgZGF0YS5sZXZlbDJDb250ZW50LnB1c2goe2lkOiB4LmlkLCBuYW1lOiB4LmNhdGFsb2dOYW1lfSkgIFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXREYXRhKGRhdGEpO1xuICAgICAgfVxuICAgICAgaWYodGhpcy5kYXRhLmRpc3BsYXlUeXBlID09IDIpIHtcbiAgICAgICAgbGV0IHRlbXAgPSByZXMuZGF0YS5jYXRhbG9nTGlzdFswXS5jYXRhbG9nTmFtZS5zcGxpdCgnLScpO1xuICAgICAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgICBsZXZlbDJDdXJyZW50bGV2ZWw6IHBhcnNlSW50KHRlbXBbMF0pLFxuICAgICAgICAgIGxldmVsMlRhcmdldGxldmVsOiBwYXJzZUludCh0ZW1wWzFdKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0RGF0YShkYXRhKVxuICAgICAgfVxuXG4gICAgICB0aGlzLmdldExldmVsMyhyZXMuZGF0YS5jYXRhbG9nTGlzdFswXS5pZCk7XG4gICAgfSlcbiAgICAuY2F0Y2gocmVzID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgfSlcbiAgfSxcbiAgbGV2ZWwyQ2hhbmdlKGUpIHtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgbGV2ZWwySW5kZXg6IHBhcnNlSW50KGUuZGV0YWlsLnZhbHVlKVxuICAgIH0pXG4gICAgdGhpcy5nZXRMZXZlbDModGhpcy5kYXRhLmxldmVsMkNvbnRlbnRbdGhpcy5kYXRhLmxldmVsMkluZGV4XS5pZClcbiAgfSxcbiAgZ2V0TGV2ZWwzKHBhcmVudElkOiBzdHJpbmcpIHtcbiAgICBhcHAucmVxdWVzdEZ1bmNQcm9taXNlKCcvc3lzdGVtL2dldENhdGFsb2dMaXN0Jywge3BhcmVudElkOiBwYXJlbnRJZCwgY2F0YWxvZ1R5cGU6IHBhcnNlSW50KHRoaXMuZGF0YS5jYXRhbG9nVHlwZSl9LCAnR0VUJylcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgIGxldmVsM0NvbnRlbnQ6IG5ldyBBcnJheTx7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nfT4oKSxcbiAgICAgICAgbGV2ZWwzRGlzcGxheU5hbWU6IHJlcy5kYXRhLmNhdGFsb2dMaXN0WzBdLmNhdGFsb2dEaXNwbGF5TmFtZSxcbiAgICAgICAgbGV2ZWwzTW9uZXk6IHJlcy5kYXRhLmNhdGFsb2dMaXN0WzBdLm1vbmV5XG4gICAgICB9XG4gICAgICByZXMuZGF0YS5jYXRhbG9nTGlzdC5mb3JFYWNoKHggPT4ge1xuICAgICAgICBkYXRhLmxldmVsM0NvbnRlbnQucHVzaCh7aWQ6IHguaWQsIG5hbWU6IHguY2F0YWxvZ05hbWV9KSAgXG4gICAgICB9KTtcbiAgICAgIHRoaXMuc2V0RGF0YShkYXRhKTtcbiAgICAgIHRoaXMuY2FsY1RvdGFsTW9uZXkoKTtcbiAgICB9KVxuICAgIC5jYXRjaChyZXMgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICB9KVxuICB9LFxuICBsZXZlbDNDaGFuZ2UoZSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBsZXZlbDNJbmRleDogcGFyc2VJbnQoZS5kZXRhaWwudmFsdWUpXG4gICAgfSlcbiAgfSxcblxuICBsZXZlbDJDdXJyZW50TGV2ZWxCbHVyKCkge1xuICAgIHRoaXMuY2FsY1RvdGFsTW9uZXkoKTtcbiAgfSxcbiAgbGV2ZWwyVGFyZ2V0TGV2ZWxCbHVyKCkge1xuICAgIHRoaXMuY2FsY1RvdGFsTW9uZXkoKTtcbiAgfSxcblxuICBsZXZlbDJDdXJyZW50TGV2ZWxJbnB1dChlKSB7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGxldmVsMkN1cnJlbnRsZXZlbDogcGFyc2VJbnQoZS5kZXRhaWwudmFsdWUpXG4gICAgfSlcbiAgfSxcbiAgbGV2ZWwyVGFyZ2V0TGV2ZWxJbnB1dChlKSB7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGxldmVsMlRhcmdldGxldmVsOiBwYXJzZUludChlLmRldGFpbC52YWx1ZSlcbiAgICB9KVxuICB9LFxuXG4gIGNhbGNUb3RhbE1vbmV5KCkge1xuICAgIGlmKHRoaXMuZGF0YS5kaXNwbGF5VHlwZSA9PSAxKSB7XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICB0b3RhbE1vbmV5OiB0aGlzLmRhdGEubGV2ZWwxTW9uZXkgKyB0aGlzLmRhdGEubGV2ZWwyTW9uZXkgKyB0aGlzLmRhdGEubGV2ZWwzTW9uZXlcbiAgICAgIH0pXG4gICAgfVxuICAgIGlmKHRoaXMuZGF0YS5kaXNwbGF5VHlwZSA9PSAyKSB7XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICB0b3RhbE1vbmV5OiB0aGlzLmRhdGEubGV2ZWwxTW9uZXkgKyAgKHRoaXMuZGF0YS5sZXZlbDJUYXJnZXRsZXZlbCAtIHRoaXMuZGF0YS5sZXZlbDJDdXJyZW50bGV2ZWwpICogdGhpcy5kYXRhLmxldmVsMk1vbmV5ICsgdGhpcy5kYXRhLmxldmVsM01vbmV5XG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICBnZXRDaGFyYWN0ZXJzKCkge1xuICAgIGNvbnN0IF90aGlzID0gdGhpcztcbiAgICBhcHAucmVxdWVzdEZ1bmMoJy91c2VyL2dldENoYXJhY3Rlckxpc3QnLCB7dXNlcklkOiB0aGlzLmRhdGEudXNlcklkLCByZWFsbVR5cGU6IHRoaXMuZGF0YS5jYXRhbG9nVHlwZX0sICdHRVQnLCByZXMgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpO1xuICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcyA9PSB0cnVlKSB7XG4gICAgICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICAgICBjaGFyYWN0ZXJzQ29udGVudDogbmV3IEFycmF5PHtpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmd9PigpXG4gICAgICAgICAgfVxuICAgICAgICAgIHJlcy5kYXRhLmxpc3QuZm9yRWFjaCh4ID0+IHtcbiAgICAgICAgICAgIGRhdGEuY2hhcmFjdGVyc0NvbnRlbnQucHVzaCh7aWQ6IHguY2hhcmFjdGVySWQsIG5hbWU6IHguY2hhcmFjdGVyTmFtZSArICcoJyArIHguYWNjb3VudE5hbWUgKyAnKScgKyAnLycgKyBfdGhpcy5kYXRhLmFsbGlhbmNlSG9yZGVNYXAuZ2V0KHguYWxsaWFuY2VIb3JkZSkgKyAnLycgKyBfdGhpcy5kYXRhLmNoYXJhY3RlckNsYXNzTWFwLmdldCh4LmNoYXJhY3RlckNsYXNzKX0pICBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLnNldERhdGEoZGF0YSlcbiAgICAgICAgfVxuICAgIH0pXG4gIH0sXG4gIGNoYXJhY3RlcnNDaGFuZ2UoZSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBjaGFyYWN0ZXJzSW5kZXg6IHBhcnNlSW50KGUuZGV0YWlsLnZhbHVlKVxuICAgIH0pXG4gIH0sXG5cbiAgY2hhbmdlQ2F0YWxvZ1R5cGUoZSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBjYXRhbG9nVHlwZTogZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudHlwZVxuICAgIH0pXG4gICAgdGhpcy5nZXRMZXZlbDEoKTtcbiAgICB0aGlzLmdldENoYXJhY3RlcnMoKTtcbiAgfSxcbiAgTmF2VG9DcmVhdGVPcmRlcigpIHtcbiAgICBsZXQgdHJhbnNkYXRhID0ge1xuICAgICAgY2hhcmFjdGVyTmFtZTogdGhpcy5kYXRhLmNoYXJhY3RlcnNDb250ZW50W3RoaXMuZGF0YS5jaGFyYWN0ZXJzSW5kZXhdLm5hbWUsXG4gICAgICBvcmRlckNhdGFsb2c6ICcnLFxuICAgICAgb3JkZXJDYXRhbG9nMTogdGhpcy5kYXRhLmxldmVsMUNvbnRlbnRbdGhpcy5kYXRhLmxldmVsMUluZGV4XS5pZCxcbiAgICAgIG9yZGVyQ2F0YWxvZzI6IHRoaXMuZGF0YS5sZXZlbDJDb250ZW50W3RoaXMuZGF0YS5sZXZlbDJJbmRleF0uaWQsXG4gICAgICBvcmRlckNhdGFsb2czOiB0aGlzLmRhdGEubGV2ZWwzQ29udGVudFt0aGlzLmRhdGEubGV2ZWwzSW5kZXhdLmlkLFxuICAgICAgbW9uZXk6IHRoaXMuZGF0YS50b3RhbE1vbmV5LFxuICAgICAgY2hhcmFjdGVySWQ6IHRoaXMuZGF0YS5jaGFyYWN0ZXJzQ29udGVudFt0aGlzLmRhdGEuY2hhcmFjdGVyc0luZGV4XS5pZFxuICAgIH1cbiAgICBpZih0aGlzLmRhdGEuZGlzcGxheVR5cGUgPT0gMSkge1xuICAgICAgdHJhbnNkYXRhLm9yZGVyQ2F0YWxvZyA9IHRoaXMuZGF0YS5sZXZlbDFDb250ZW50W3RoaXMuZGF0YS5sZXZlbDFJbmRleF0ubmFtZSArICcvJyArIHRoaXMuZGF0YS5sZXZlbDJDb250ZW50W3RoaXMuZGF0YS5sZXZlbDJJbmRleF0ubmFtZSArICcvJyArIHRoaXMuZGF0YS5sZXZlbDNDb250ZW50W3RoaXMuZGF0YS5sZXZlbDNJbmRleF0ubmFtZVxuICAgIH1cbiAgICBpZih0aGlzLmRhdGEuZGlzcGxheVR5cGUgPT0gMikge1xuICAgICAgdHJhbnNkYXRhLm9yZGVyQ2F0YWxvZyA9IHRoaXMuZGF0YS5sZXZlbDFDb250ZW50W3RoaXMuZGF0YS5sZXZlbDFJbmRleF0ubmFtZSArICcvJyArIHRoaXMuZGF0YS5sZXZlbDJDdXJyZW50bGV2ZWwgKyAnLScgKyB0aGlzLmRhdGEubGV2ZWwyVGFyZ2V0bGV2ZWwgKyAnLycgKyB0aGlzLmRhdGEubGV2ZWwzQ29udGVudFt0aGlzLmRhdGEubGV2ZWwzSW5kZXhdLm5hbWVcbiAgICB9XG4gICAgY29uc3QgY29tRGF0YSA9IEpTT04uc3RyaW5naWZ5KHRyYW5zZGF0YSlcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgIHVybDogJy4uLy4uL09yZGVyU2VydmljZS9PcmRlckVudHJ5L09yZGVyRW50cnknICsgJz9kYXRhPScgKyBjb21EYXRhLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXsgfSxcbiAgICAgIGZhaWw6IGZ1bmN0aW9uKCkgeyB9LFxuICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCkgeyB9XG4gICAgfSlcbiAgfSxcbn0pXG4iXX0=